<script>
  //срабатывает при успешноь вызове в withSuccessHandle
  function successReceivingData(e) {
    console.log('successReceivingData', e);
    google.script.run.completedWithoutErrors(e);
  }
  //срабатывает при ошибке в withFailureHandler
  function onFailureHandler(e) {
    console.log('onFailureHandler', e);
    google.script.run.doneWithAnError(e);
  }

  // получает имя листа confirmed стр. 14 и запускает sendDataToServer с именем листа в качестве аргумента
  function getStarted() {
    console.log('getStarted', arguments);
    google.script.run.withSuccessHandler(sendDataToServer).getId();
  }
  // запускает addContent на сервере и получает контент листа
  function sendDataToServer(id) {
    console.log('sendDataToServer', id);
    alert(id);
    google.script.run
      .withSuccessHandler(successReceivingData)
      .withFailureHandler(onFailureHandler)
      .withUserObject(this) // Этот this указывает не туда
      .addContent(id);
  }
</script>
